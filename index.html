<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>BST 260 Final Project - District-Level Trends in Postpartum Contraceptive Use in Senegal Following a Contraceptive Supply Chain Intervention</title>

<script src="site_libs/header-attrs-2.13/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">BST 260 Final Project - District-Level Trends in Postpartum Contraceptive Use in Senegal Following a Contraceptive Supply Chain Intervention</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Final Project</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">BST 260 Final Project - District-Level
Trends in Postpartum Contraceptive Use in Senegal Following a
Contraceptive Supply Chain Intervention</h1>

</div>


<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>In 2012, the Senegalese government implemented the Informed Push
Model (IPM), a supply chain model where third-party logisticians were
contracted to deliver family planning supplies to service delivery
points directly from regional storerooms. After the intervention pilot
in Dakar in 2012 nearly eliminated stock-outs for contraceptives, the
Senegalese government decided to expand the IPM across different
districts over a 3-year period before scaling up the intervention at a
national level.[1] There is limited evidence on the impact of the IPM on
contraceptive use.[2] To help fill this gap, this work will look at
trends in modern contraceptive use among postpartum women (an important
beneficiary group of family planning policies and programs given the
benefits of increased birth intervals on the health of mothers and their
babies) before and after the IPM was implemented. Districts where the
IPM was implemented prior to January 2015 will serve as the intervention
districts. These districts are Dakar (Dec 2012); Kaolack and Thies (Apr
2013); Diourbel, Fatick, Kaffrine and Matam (Mar 2014); Saint-Louis (Apr
2014); and Louga (Jul 2014). Districts where the IPM was implemented
after January 2015 will serve as comparison districts (Tambacounda,
Kolda, Kedougou, Sedhiou and Ziguinchor).</p>
<p>The Demographic and Health Survey (DHS) is a nationally
representative survey that collects information on socio-demographic
characteristics, reproduction, knowledge and use of contraception,
fertility preferences, among others. The DHS collects information on
women’s reproductive history through its contraceptive calendar, a
string variable containing 80 characters (with each character
representing a month) that provides a retrospective account recording
births, pregnancies, terminations, and contraceptive use over the 80
months preceding the survey’s publication (usually August of the year
following data collection). This information can be used to determine
whether, at any given month before the survey, a respondent was within
the first postpartum year, and whether she was using a modern method of
contraception. Data from Senegal’s 2014, 2015 and 2016 Continuous DHS
were obtained [3]. The original data sets contain 3989 (2014), 3998
(2015) and 4070 (2016) variables; and n=8488 (2014), n=8851 (2015) and
n=8865 (2016) observations for women ages 15-49. For this analysis, I
will limit the study sample to include only respondents who have given
birth in the 5 years preceding each survey (n=4584 in 2014, n=4799 in
2015 and n=4726 in 2016). The main variables that will be utilized for
this analysis are individual sample weights, respondent’s district of
residence, and the calendar variable:</p>
<pre><code>## # A tibble: 6 × 3
##   individual_weight  district calendar_variable                                 
##               &lt;dbl&gt; &lt;dbl+lbl&gt; &lt;chr&gt;                                             
## 1              3.19 1 [dakar] &quot;                   0000BPPPPPPPP0000000000000000…
## 2              3.19 1 [dakar] &quot;                   PPPPPPP11111100000000BPPPPPPP…
## 3              3.19 1 [dakar] &quot;                   00BPPPPPPPP000000000000000000…
## 4              3.19 1 [dakar] &quot;                   PPPP0000000000000000000000000…
## 5              3.19 1 [dakar] &quot;                   3333333333333TP00000BPPPPPPPP…
## 6              3.19 1 [dakar] &quot;                   11111111111111111111111111111…</code></pre>
</div>
<div id="methodology" class="section level1">
<h1>Methodology</h1>
<p>The outcome variable in this analysis is the monthly rate of
postpartum modern contraceptive use. I use an adapted version of the
UNFPA definition of modern contraceptive methods: hormonal implants,
IUDs, female and male sterilization, hormonal pills and injectables,
male and female condoms, and other supply methods.[4] The denominator of
my outcome variable is the total number of women who were within one
year of their last delivery. Among those women, the numerator is the
number that are using a modern method of contraception. The codes for
events captured in the string are:</p>
<ul>
<li><p>“B” - Birth</p></li>
<li><p>“P” - Pregnancy</p></li>
<li><p>“T” - Terminated pregnancy/non-live birth</p></li>
<li><p>“0” - No contraception</p></li>
<li><p>Traditional methods of contraception</p>
<ul>
<li>“8” - Periodic abstinence</li>
<li>“9” - Withdrawal</li>
<li>“W” - Other traditional methods</li>
<li>“L” - Lactational amenorrhea method</li>
</ul></li>
<li><p>Modern methods of contraception</p>
<ul>
<li>“1” - Pill</li>
<li>“2” - IUD</li>
<li>“3” - Injectables</li>
<li>“4” - Diaphragm</li>
<li>“5” - Condom</li>
<li>“6” - Female sterilization</li>
<li>“7” - Male sterilization</li>
<li>“N” - Implants</li>
<li>“C” - Female condom</li>
<li>“F” - Foam and jelly</li>
<li>“E” - Emergency contraception</li>
<li>“M” - Other modern method</li>
</ul></li>
</ul>
<p>The methodology for this analysis will consist of string variable
manipulation to check whether a respondent was within the first year
postpartum within a given month (denominator) and of those, whether a
respondent was using a modern method of contraception within a given
month (numerator). This will yield six different data frames, two for
each survey year. One data frame will have, for each respondent, whether
or not they were using a modern method of contraception at each month
over the 80 months prior to the survey. Similarly, the other data frame
will record, for each respondent, whether or not at a given month they
were within the first year postpartum. I complete this process for each
survey year separately and will then join the six data frames into two
data frames, one for postpartum observations for all survey years and
the other for contraceptive use observations for all survey years. Once
I’ve completed this step, I will calculate the postpartum contraceptive
use rate for each month using the weights provided for the sampling
units. I will graph these monthly rates for each district with
visualizations for the month of the intervention in that district and
will use smoothing to try to visualize differences in patterns/trends
before and after the intervention took place. I will also plot each
intervention district with the comparison districts.</p>
</div>
<div id="results" class="section level1">
<h1>Results</h1>
<p>Extensiva data wrangling was necessary to analyze this dataset. The
string variable had to be parsed to be able to extract monthly
contraceptive usage and also to verify whether the respondent was
situated within the postpartum period. For the latter, I had to identify
the position on the string for the month I was interested in, and also
check the 12 preceding months to ascertain whether at any point in those
previous 12 months a respondent had given birth. To illustrate this
process, I show the contraceptive calendar of the 77nd respondent from
our 2014 DHS sample (prior to any string manipulation):</p>
<pre><code>## [1] &quot;                  N0BPPPPPPPP00000BPPPPPPPP0000000000000000000000000000000000000&quot;</code></pre>
<p>Read from left to right, there are 18 spaces from the start of the
string to the first non-blank character, representing the 18 months
between the date of publication of these data (August 2015) to the month
the 77nd respondent was interviewed (February 2014). On February 2014
(19 months before August 2015), this respondent has code “N”, which
means that she was using implants:</p>
<pre><code>## [1] &quot;N&quot;</code></pre>
<p>The function check_mc I created can verify that this is a modern
method of contraception and this respondent would be counted as having
used a modern method of contraception on February 2014 (where a value =
1 means a modern method was used):</p>
<pre><code>## [1] 1</code></pre>
<p>We can also see from the vcal_1 shown above that the respondent had
given birth shortly before the month she was using an implant. We can
use the check_pp function to verify whether on February 2014 she was
within one month post-partum.</p>
<pre><code>## [1] TRUE</code></pre>
<p>Therefore, since on February 2014 this woman was within her first
year postpartum and since she was also using a modern method of
contraception, she would be counted in the numerator of our postpartum
contraceptive use monthly rate. On the other hand, if we again take this
same woman, on January 2014 (20 months before August 2015) we can see
that she was not using a modern method of contraception, and she was
also within the first year postpartum:</p>
<pre class="r"><code>substr(d_14$vcal_1[77], 20, 20) #extract character for 20th month pre-interview</code></pre>
<pre><code>## [1] &quot;0&quot;</code></pre>
<pre class="r"><code>check_mc(d_14$vcal_1[77], 20) |&gt; print() #check whether modern method (0=not modern method)</code></pre>
<pre><code>## [1] 0</code></pre>
<pre class="r"><code>within_pp(d_14$vcal_1[77], 20) |&gt; print() #check within postpartum</code></pre>
<pre><code>## [1] TRUE</code></pre>
<p>This means that while on February 2014 she is counted in the
numerator and denominator, on January 2014 she is only counted in the
denominator We repeat this for every month for each respondent in all
three years’ datasets.</p>
<p>I combined the three years’ data frames into two data frames (one for
whether a respondent was in the first year postpartum and one for
whether she was using a modern method of contraception). A part of one
of the tables is displayed below, showing monthly contraceptive use for
respondents 1 through 6 in the combined data frame for the 17-25 months
prior to August 2017 (August 2015-April 2016).</p>
<pre><code>##   17 18 19 20 21 22 23 24 25
## 1  1  1  1  1  1  1  0  0  0
## 2  0  0  0  0  0  0  0  0  0
## 3  1  1  1  1  1  1  1  1  1
## 4  0  0  0  0  0  0  0  0  0
## 5  1  1  0  0  0  0  0  0  0
## 6  1  1  1  1  1  1  1  1  1</code></pre>
<p>I calculated the monthly contraceptive use rate for January 2010
through June 2015 by district and used pivot_longer to restructure the
data into a time-series data frame with one observation (“value”, the
rate) for each district for each month. I used the lubridate package to
generate the dates to make it easier to understand the plots of my
results.</p>
<pre><code>## # A tibble: 14 × 4
##    district value month my        
##    &lt;fct&gt;    &lt;dbl&gt; &lt;int&gt; &lt;date&gt;    
##  1 Dakar    0.389    27 2015-06-01
##  2 Dakar    0.305    28 2015-05-01
##  3 Dakar    0.302    29 2015-04-01
##  4 Dakar    0.340    30 2015-03-01
##  5 Dakar    0.322    31 2015-02-01
##  6 Dakar    0.327    32 2015-01-01
##  7 Dakar    0.336    33 2014-12-01
##  8 Dakar    0.367    34 2014-11-01
##  9 Dakar    0.350    35 2014-10-01
## 10 Dakar    0.375    36 2014-09-01
## 11 Dakar    0.413    37 2014-08-01
## 12 Dakar    0.410    38 2014-07-01
## 13 Dakar    0.378    39 2014-06-01
## 14 Dakar    0.367    40 2014-05-01</code></pre>
<p>Once this was done, I could plot graphs of the monthly rate for each
district. I visualize my results in two ways. The first depicts the
monthly rate of postpartum contraceptive use for intervention districts
only. I added a vertical line at the month and year when the IPM was
implemented in each of the intervention districts and used geom_smooth
using the loess curve method to get a better sense of the trends before
and after the intervention took place. Below I show the original and
smoothed trends for Diourbel district:
<img src="index_files/figure-html/unnamed-chunk-12-1.png" width="672" />
I decided to compare trends in intervention districts with districts
that did not receive the intervention until after 2015. This will help
me get a better sense of whether any changes in levels and/or trends
after the IPM in intervention districts was due to IPM or due to other
things happening in Senegal that affected non-intervention districts
too. Below I show trends for Diourbel and comparison districts:
<img src="index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<p>In this project, I used data wrangling and visualization, as well as
smoothing to generate a descriptive, visual analysis of trends of
postpartum contraceptive use among women in Senegal at the district
level.</p>
<p>In the future, I will use this project to conduct a
difference-in-differences analysis to evaluate the impact of the IPM on
postpartum modern contraceptive use in Senegal at the district level.
This exploratory analysis has successfully helped me identify that there
are trends in the data that would be worth exploring through a more
rigorous analysis.</p>
<p>If I had more time, some additional topics I could include in my
analysis could be the use of synthetic controls to see whether the
national scale-up of IPM (including all 14 of Senegal’s districts) had
an impact on national postpartum contraceptive use.</p>
</div>
<div id="references" class="section level1">
<h1>References</h1>
<p>[1] Cavallaro, F.L., Duclos, D., Baggaley, R.F. et al. Taking stock:
protocol for evaluating a family planning supply chain intervention in
Senegal. Reprod Health 13, 45 (2016). <a
href="https://doi.org/10.1186/s12978-016-0163-7"
class="uri">https://doi.org/10.1186/s12978-016-0163-7</a></p>
<p>[2] Krug C, Cavallaro FL, Wong KLM, Gasparrini A, Faye A, Lynch CA.
Evaluation of Senegal supply chain intervention on contraceptive
stockouts using routine stock data. PLoS One. 2020 Aug 3;15(8):e0236659.
doi: 10.1371/journal.pone.0236659. PMID: 32745110; PMCID:
PMC7398546.</p>
<p>[3] ICF International. Demographic and Health Surveys (various)
[Datasets]. <a href="https://dhsprogram.com/data/available-datasets.cfm"
class="uri">https://dhsprogram.com/data/available-datasets.cfm</a>. Date
accessed: December 2022</p>
<p>[4] Singh S, Darroch J, Ashford L. Adding it up: the costs and
benefits of investing in sexual and reproductive health. New York:
Guttmacher Institute and United Nations Population Fund; 2014 [Available
at: <a
href="https://www.unfpa.org/sites/default/files/pub-pdf/Adding%20It%20Up-Final-"
class="uri">https://www.unfpa.org/sites/default/files/pub-pdf/Adding%20It%20Up-Final-</a>
11.18.14.pdf, Last accessed 5 November 2022].</p>
</div>
<div id="appendix-code-tables-and-graphs" class="section level1">
<h1>Appendix: Code, tables and graphs</h1>
<p>Code, tables and graphs</p>
<pre class="r"><code>#Installing packages
library(haven)
library(stringr)
library(dplyr)
library(tidyverse)
library(tibble)
library(expss)
library(vctrs)
library(labelled)
library(ggpubr)
library(lubridate) 

## Importing the data
senegal_14 &lt;- read_dta(&quot;/Users/deaoviedo/Documents/grad/classes/2 THESIS/data/Senegal 2014/SNIR70DT/SNIR70DT/SNIR70FL.DTA&quot;)
senegal_15 &lt;- read_dta(&quot;/Users/deaoviedo/Documents/grad/classes/2 THESIS/data/Senegal 2015/SNIR7HDT/SNIR7HFL.DTA&quot;)
senegal_16 &lt;- read_dta(&quot;/Users/deaoviedo/Documents/grad/classes/2 THESIS/data/Senegal 2016/SNIR7IDT/SNIR7IDT/SNIR7IFL.DTA&quot;)

## Generating variable for women who have given birth in the dataset (at any time)
senegal_14$gave_birth &lt;- as.integer(str_detect(senegal_14$vcal_1, &quot;B&quot;))
senegal_15$gave_birth &lt;- as.integer(str_detect(senegal_15$vcal_1, &quot;B&quot;))
senegal_16$gave_birth &lt;- as.integer(str_detect(senegal_16$vcal_1, &quot;B&quot;))

## Generating weight variable
senegal_14$wt &lt;- senegal_14$v005/1000000
senegal_15$wt &lt;- senegal_15$v005/1000000
senegal_16$wt &lt;- senegal_16$v005/1000000

## Creating separate data frames with sample of only women who have given birth in 5 yrs preceding survey
d_14 &lt;- senegal_14 |&gt; filter(gave_birth == 1)
d_15 &lt;- senegal_15 |&gt; filter(gave_birth == 1)
d_16 &lt;- senegal_16 |&gt; filter(gave_birth == 1)

## Viewing main variables for this analysis
d_14 |&gt;
  rename(individual_weight=wt, calendar_variable = vcal_1, district = v024) |&gt;
  select(individual_weight, district, calendar_variable)</code></pre>
<pre><code>## # A tibble: 4,584 × 3
##    individual_weight  district calendar_variable                                
##                &lt;dbl&gt; &lt;dbl+lbl&gt; &lt;chr&gt;                                            
##  1              3.19 1 [dakar] &quot;                   0000BPPPPPPPP000000000000000…
##  2              3.19 1 [dakar] &quot;                   PPPPPPP11111100000000BPPPPPP…
##  3              3.19 1 [dakar] &quot;                   00BPPPPPPPP00000000000000000…
##  4              3.19 1 [dakar] &quot;                   PPPP000000000000000000000000…
##  5              3.19 1 [dakar] &quot;                   3333333333333TP00000BPPPPPPP…
##  6              3.19 1 [dakar] &quot;                   1111111111111111111111111111…
##  7              3.19 1 [dakar] &quot;                   1110BPPPPPPPP0011111111100BP…
##  8              3.19 1 [dakar] &quot;                   6666666666666666666666666666…
##  9              3.19 1 [dakar] &quot;                   00000000000000000BPPPPPPPP00…
## 10              3.19 1 [dakar] &quot;                   3333333333330000000000000000…
## # … with 4,574 more rows</code></pre>
<pre class="r"><code>## Names of districts in Senegal
val_lab(d_14$v024)</code></pre>
<pre><code>##       dakar  ziguinchor    diourbel saint-louis tambacounda     kaolack 
##           1           2           3           4           5           6 
##       thiès       louga      fatick       kolda       matam    kaffrine 
##           7           8           9          10          11          12 
##    kedougou     sedhiou 
##          13          14</code></pre>
<pre class="r"><code>## A closer look at the calendar variable
head(d_14$vcal_1)</code></pre>
<pre><code>## [1] &quot;                   0000BPPPPPPPP00000000000000000000BPPPPPPPP0000000000000000000&quot;
## [2] &quot;                   PPPPPPP11111100000000BPPPPPPPP0000000000033333333333333333333&quot;
## [3] &quot;                   00BPPPPPPPP00000000000000000000000000000000000000000000000000&quot;
## [4] &quot;                   PPPP0000000000000000000000000000BPPPPPPPP00000000000000000000&quot;
## [5] &quot;                   3333333333333TP00000BPPPPPPPP0000000000000TPPPPPP0000000000BP&quot;
## [6] &quot;                   111111111111111111111111111111111111111111111100BPPPPPPPP0011&quot;</code></pre>
<pre class="r"><code>table(str_length(d_14$vcal_1)) #confirming variable length of 80 characters</code></pre>
<pre><code>## 
##   80 
## 4584</code></pre>
<pre class="r"><code>## Check whether at each row of the calendar variable the respondent was using a modern method of contraception
data_mc_14 &lt;- data.frame(matrix(NA,
                             nrow = nrow(d_14),
                             ncol = 80))

data_mc_15 &lt;- data.frame(matrix(NA,
                             nrow = nrow(d_15),
                             ncol = 80))

data_mc_16 &lt;- data.frame(matrix(NA,
                             nrow = nrow(d_16),
                             ncol = 80))

    #Create a function to detect contraceptive method within a specific row &quot;pos&quot;
    check_mc &lt;- function(calendar, pos) {
      sample_cal &lt;- substr(calendar, pos, pos)
      using &lt;- as.integer(str_detect(sample_cal, &quot;[1234567NCFEM]&quot;))
    }
    
    #Apply check_mc function to each row in the calendar variable
    using_mc_14 &lt;- for(i in 1:80){
      uses &lt;- check_mc(d_14$vcal_1, i)
      data_mc_14[ , i] &lt;- uses
    }
    
    using_mc_15 &lt;- for(i in 1:80){
      uses &lt;- check_mc(d_15$vcal_1, i)
      data_mc_15[ , i] &lt;- uses
    }

    using_mc_16 &lt;- for(i in 1:80){
      uses &lt;- check_mc(d_16$vcal_1, i)
      data_mc_16[ , i] &lt;- uses
    }


## Check whether respondents were within 12 months postpartum at particular month
data_pp_14 &lt;- data.frame(matrix(NA,
                             nrow = nrow(d_14),
                             ncol = 80))

data_pp_15 &lt;- data.frame(matrix(NA,
                             nrow = nrow(d_15),
                             ncol = 80))

data_pp_16 &lt;- data.frame(matrix(NA,
                             nrow = nrow(d_16),
                             ncol = 80))

    #Create a function to detect whether respondent was within 1yr postpartum 
    #within a specific row &quot;pos&quot;
    within_pp &lt;- function(calendar, pos) {
      oneyear &lt;- substr(calendar, pos+1, pos+12)
      str_detect(oneyear, &quot;B&quot;)
    }

    #Function to detect and ignore blank rows at the beginning of the calendar 
    #variable
    blanks &lt;- function(calendar, pos) {
      currentmonth &lt;- substr(calendar, pos, pos)
      str_detect(currentmonth, &quot;\\s&quot;)
    }
    
    #Apply within_pp function to each row in the calendar variable
    for(i in 1:80){
      blankignore &lt;- as.integer(blanks(d_14$vcal_1, i))
      postpartum &lt;- as.integer(within_pp(d_14$vcal_1, i))
      real_pp &lt;- ifelse(blankignore == 1, NA, postpartum)
      data_pp_14[ , i] &lt;- real_pp
    }
    
    for(i in 1:80){
      blankignore &lt;- as.integer(blanks(d_15$vcal_1, i))
      postpartum &lt;- as.integer(within_pp(d_15$vcal_1, i))
      real_pp &lt;- ifelse(blankignore == 1, NA, postpartum)
      data_pp_15[ , i] &lt;- real_pp
    }

    for(i in 1:80){
      blankignore &lt;- as.integer(blanks(d_16$vcal_1, i))
      postpartum &lt;- as.integer(within_pp(d_16$vcal_1, i))
      real_pp &lt;- ifelse(blankignore == 1, NA, postpartum)
      data_pp_16[ , i] &lt;- real_pp
    }

## Adding region variable to data frame
data_mc_14$region &lt;- d_14$v024
data_mc_15$region &lt;- d_15$v024
data_mc_16$region &lt;- d_16$v024

## Adding weight variable to data frame
data_mc_14$wt &lt;- d_14$wt
data_mc_15$wt &lt;- d_15$wt
data_mc_16$wt &lt;- d_16$wt

## Adding ID
data_mc_14$caseid &lt;- d_14$caseid
data_mc_15$caseid &lt;- d_15$caseid
data_mc_16$caseid &lt;- d_16$caseid

## Adding survey year
data_mc_14$survey_year &lt;- d_14$v007
data_mc_15$survey_year &lt;- d_15$v007
data_mc_16$survey_year &lt;- d_16$v007

## Renaming column names to represent the number of months prior to August 2017 (the month and year the 2016 survey data were published)
names(data_mc_14)[1:80] &lt;- 25:104
names(data_pp_14)[1:80] &lt;- 25:104
names(data_mc_15)[1:80] &lt;- 13:92
names(data_pp_15)[1:80] &lt;- 13:92
names(data_mc_16)[1:80] &lt;- 1:80
names(data_pp_16)[1:80] &lt;- 1:80


full_data_mc &lt;- bind_rows(data_mc_16, data_mc_15, data_mc_14)
full_data_mc &lt;- full_data_mc |&gt; relocate(&quot;caseid&quot;, &quot;survey_year&quot;, &quot;region&quot;, &quot;wt&quot;, .after = last_col())
names(full_data_mc)</code></pre>
<pre><code>##   [1] &quot;1&quot;           &quot;2&quot;           &quot;3&quot;           &quot;4&quot;           &quot;5&quot;          
##   [6] &quot;6&quot;           &quot;7&quot;           &quot;8&quot;           &quot;9&quot;           &quot;10&quot;         
##  [11] &quot;11&quot;          &quot;12&quot;          &quot;13&quot;          &quot;14&quot;          &quot;15&quot;         
##  [16] &quot;16&quot;          &quot;17&quot;          &quot;18&quot;          &quot;19&quot;          &quot;20&quot;         
##  [21] &quot;21&quot;          &quot;22&quot;          &quot;23&quot;          &quot;24&quot;          &quot;25&quot;         
##  [26] &quot;26&quot;          &quot;27&quot;          &quot;28&quot;          &quot;29&quot;          &quot;30&quot;         
##  [31] &quot;31&quot;          &quot;32&quot;          &quot;33&quot;          &quot;34&quot;          &quot;35&quot;         
##  [36] &quot;36&quot;          &quot;37&quot;          &quot;38&quot;          &quot;39&quot;          &quot;40&quot;         
##  [41] &quot;41&quot;          &quot;42&quot;          &quot;43&quot;          &quot;44&quot;          &quot;45&quot;         
##  [46] &quot;46&quot;          &quot;47&quot;          &quot;48&quot;          &quot;49&quot;          &quot;50&quot;         
##  [51] &quot;51&quot;          &quot;52&quot;          &quot;53&quot;          &quot;54&quot;          &quot;55&quot;         
##  [56] &quot;56&quot;          &quot;57&quot;          &quot;58&quot;          &quot;59&quot;          &quot;60&quot;         
##  [61] &quot;61&quot;          &quot;62&quot;          &quot;63&quot;          &quot;64&quot;          &quot;65&quot;         
##  [66] &quot;66&quot;          &quot;67&quot;          &quot;68&quot;          &quot;69&quot;          &quot;70&quot;         
##  [71] &quot;71&quot;          &quot;72&quot;          &quot;73&quot;          &quot;74&quot;          &quot;75&quot;         
##  [76] &quot;76&quot;          &quot;77&quot;          &quot;78&quot;          &quot;79&quot;          &quot;80&quot;         
##  [81] &quot;81&quot;          &quot;82&quot;          &quot;83&quot;          &quot;84&quot;          &quot;85&quot;         
##  [86] &quot;86&quot;          &quot;87&quot;          &quot;88&quot;          &quot;89&quot;          &quot;90&quot;         
##  [91] &quot;91&quot;          &quot;92&quot;          &quot;93&quot;          &quot;94&quot;          &quot;95&quot;         
##  [96] &quot;96&quot;          &quot;97&quot;          &quot;98&quot;          &quot;99&quot;          &quot;100&quot;        
## [101] &quot;101&quot;         &quot;102&quot;         &quot;103&quot;         &quot;104&quot;         &quot;caseid&quot;     
## [106] &quot;survey_year&quot; &quot;region&quot;      &quot;wt&quot;</code></pre>
<pre class="r"><code>full_data_pp &lt;- bind_rows(data_pp_16, data_pp_15, data_pp_14)


## Creating monthly outcome var
monthly_rate_all &lt;- data.frame(matrix(NA,
                                     nrow = 14,
                                     ncol = 104))

for(i in 1:104){
  full_data_mc$numerator &lt;- ifelse(full_data_mc[,i] == 1 &amp; full_data_pp[,i] == 1, 1, 0)
  full_data_mc$denominator &lt;- full_data_pp[,i]
  rate &lt;- full_data_mc |&gt; filter(denominator == 1) |&gt; group_by(region) |&gt; 
    summarize(weighted.mean(numerator, wt))
  monthly_rate_all[,i] &lt;- rate[,2]
}


## restructure data
monthly_rate_all$district &lt;- 1:14
monthly_rate_all &lt;- pivot_longer(monthly_rate_all, cols=-district)
monthly_rate_all$name &lt;- gsub(&#39;X&#39;,&#39;&#39;,monthly_rate_all$name)
monthly_rate_all$month &lt;- as.integer(monthly_rate_all$name)
monthly_rate_all &lt;- select(monthly_rate_all, -name)


monthly_rate_all$district &lt;- factor(monthly_rate_all$district,
                                   levels = c(1,2,3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14),
                                   labels = c(&quot;Dakar&quot;, &quot;Ziguinchor&quot;, &quot;Diourbel&quot;, &quot;Saint-Louis&quot;,
                                              &quot;Tambacounda&quot;, &quot;Kaolack&quot;, &quot;Thies&quot;, &quot;Louga&quot;,
                                              &quot;Fatick&quot;, &quot;Kolda&quot;, &quot;Matam&quot;, &quot;Kaffrine&quot;, 
                                              &quot;Kedougou&quot;, &quot;Sedhiou&quot;))


monthly_rate_all &lt;- monthly_rate_all |&gt; filter(month &gt; 26 &amp; month &lt; 93)

xaxis &lt;- seq(as.Date(&quot;2010/1/1&quot;), by = &quot;month&quot;, length.out = 66) 
monthly_rate_all$my &lt;- vec_rep(rev(xaxis), 14)

#Preparing data for graphing
phase_1 &lt;- c(&quot;Dakar&quot;)
phase_2 &lt;- c(&quot;Thies&quot;, &quot;Kaolack&quot;)
phase_3 &lt;- c(&quot;Diourbel&quot;, &quot;Kaffrine&quot;, &quot;Fatick&quot;, &quot;Matam&quot;)
phase_4 &lt;- c(&quot;Saint-Louis&quot;, &quot;Louga&quot;)
comparison &lt;- c(&quot;Tambacounda&quot;, &quot;Kedougou&quot;, &quot;Kolda&quot;, &quot;Sedhiou&quot;, &quot;Ziguinchor&quot;)


monthly_rate_all &lt;- monthly_rate_all |&gt; 
  mutate(phase=case_when(district %in% phase_1~&quot;intervention district&quot;,
                         district %in% phase_2~&quot;intervention district&quot;,
                         district %in% phase_3~&quot;intervention district&quot;,
                         district %in% phase_4~&quot;intervention district&quot;,
                         TRUE~&quot;comparison district&quot;))

## Graphing intervention districts alone
monthly_rate_all |&gt; filter(district == &quot;Dakar&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[37]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Dakar - June 2012&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Thies&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[27]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Thies - April 2013&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-2.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Kaolack&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[27]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Kaolack - April 2013&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-3.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Diourbel&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[16]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Diourbel - March 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-4.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Kaffrine&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[16]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Kaffrine - March 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-5.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Fatick&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[16]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Fatick - March 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-6.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Matam&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[16]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Matam - March 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-7.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Saint-Louis&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[15]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Saint-Louis - April 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-8.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Louga&quot;) |&gt;
  ggplot(aes(my, value))+
  geom_line(aes(group=district))+
  geom_smooth(aes(group = district),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[12]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Louga - July 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-9.png" width="672" /></p>
<pre class="r"><code>## Graphing with comparison districts
monthly_rate_all |&gt; filter(district == &quot;Dakar&quot; | district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[37]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Dakar - June 2012&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-10.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Thies&quot;| district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[27]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Thies - April 2013&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-11.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Kaolack&quot; | district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[27]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Kaolack - April 2013&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-12.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Diourbel&quot; | district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[16]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Diourbel - March 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-13.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Kaffrine&quot; | district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[16]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Kaffrine - March 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-14.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Fatick&quot; | district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[16]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Fatick - March 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-15.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Matam&quot; | district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[16]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Matam - March 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-16.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Saint-Louis&quot; | district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[15]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Saint-Louis - April 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-17.png" width="672" /></p>
<pre class="r"><code>monthly_rate_all |&gt; filter(district == &quot;Louga&quot; | district %in% comparison) |&gt;
  ggplot(aes(my, value))+
  geom_smooth(aes(group = district, color=phase),  
              method = &quot;loess&quot;, formula=y~x, se = FALSE) +
  geom_vline(xintercept = as.numeric(monthly_rate_all$my[12]))+
  theme_bw()+
  ylab(&quot;% using modern contraception&quot;)+
  xlab(&quot;Time&quot;)+
  scale_x_date(date_breaks = &quot;1 month&quot;, date_labels =  &quot;%b %Y&quot;)+
  theme(axis.text.x=element_text(angle=60, hjust=1, size = 5))+
  ggtitle(&quot;Louga - July 2014&quot;)+
  theme(legend.position = &quot;none&quot;)</code></pre>
<p><img src="index_files/figure-html/unnamed-chunk-14-18.png" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
